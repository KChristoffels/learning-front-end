<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>It's a snake!</title>
    </head>

    <body> 
        <h1>Welcome to snake!</h1>

        <button id="play" value="play">Play snake!</button>        
        <select id="colorSelector">
            <option>green</option>
            <option>blue</option>
            <option>red</option>
            <option>orange</option>
        </select>
        

        <div id="scoreBoard">Score: </div> 

        <canvas id="gameCanvas" width="300" height="300">&lt;canvas>

        

    <script>
        let play = document.getElementById("play");
        play.addEventListener("click", playSnake);

             

        var anaconda = setInterval(0);

        let canvas = document.getElementById("gameCanvas");
        canvas.style.border = "1px solid black";
        let context = canvas.getContext("2d"); // added the 2d property
        let scoreBoard = document.getElementById("scoreBoard");
        let score = 0;
        let dx = 10;
        let dy = 0;
        let snakeSpeed = 150;

        let colorSelector = document.getElementById("colorSelector"); 
        colorSelector.addEventListener("change", changeColor);
        colorSelector.value = "green";

        let snake = [  {x: 150, y: 150},  {x: 140, y: 150},  {x: 130, y: 150},  {x: 120, y: 150},  {x: 110, y: 150},];

        function clearSelection() {
            let sel;
            if (sel = document.selection) {
            sel.empty();
            }
        }
        
        function drawSnakePart(snakePart) {
            context.fillStyle = colorSelector.value; context.strokeStyle = colorSelector.value; context.fillRect(snakePart.x, snakePart.y, 10, 10); context.strokeRect(snakePart.x, snakePart.y, 10, 10);
        } 

        function drawSnake() {
            snake.forEach(drawSnakePart);
        } // drawSnakePart gets fed each coordinate from the snake-array and subsequently draws the rectangle

        drawSnake()

        console.log(colorSelector.value);

        function changeColor(event) { // assigns new color to the snake when selected from the list
            console.log(colorSelector.value);
            switch(true){
                case (colorSelector.value == "green"): 
                    drawSnake()
                    break;
                case (colorSelector.value == "blue"):
                    drawSnake()
                    break;
                case (colorSelector.value == "red"): 
                    drawSnake()
                    break;
                case (colorSelector.value == "orange"):
                    drawSnake()
                    break;
                    
                default:
            }
        } 
        
        function clearCanvas () { //removes visual element from last snakepart
            context.fillStyle = 'white'; context.strokeStyle = 'black'; context.fillRect(0, 0, canvas.width, canvas.height); context.strokeRect(0, 0, canvas.width, canvas.height);
        } 
        function moveSnake() {
            
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};
            snake.unshift(head); // makes a new head and adds it to the front to simulate moving
            if (didGameEnd()) { clearInterval(anaconda); console.log("Game over \b insert coin")} 
            // when the snake head touches one of its own parts the game ends
            else {            
                       
            const didEatFood = snake[0].x === foodX && snake[0].y === foodY;
                if (didEatFood) {
                    snakeSpeed= snakeSpeed-(0.75); // everytime the snake eats, speed is increased by 0.75
                    console.log(snakeSpeed);                    
                    createFood();
                    drawFood();
                    score++;
                    scoreBoard.innerHTML = "Score: " + score; // make the snake longer when it eats food, no end canvas is removed 
                    
                } else {                    
                    snake.forEach(element => {
                       if (element.x < 0) {
                           element.x = 290;
                       }
                    }); // if the snake hits the left wall
                    snake.forEach(element => {
                       if (element.x > 290) {
                           element.x = 0;
                       }
                    }); // if the snake hits the right wall
                    snake.forEach(element => {
                       if (element.y < 0) {
                           element.y = 290;
                       }
                    }); // if the snake hits the top wall
                    snake.forEach(element => {
                       if (element.y > 290) {
                           element.y = 0;
                       }
                    }); // if the snake hits the bottom wall
                    snake.pop();
                    clearCanvas();
                    
                }
            drawSnake();
            drawFood(); 
            } 
        }
                                 
        
        document.addEventListener("keydown", changeDirection);
        function changeDirection(event) {
            const LEFT_KEY = 37;  const RIGHT_KEY = 39;  const UP_KEY = 38;  const DOWN_KEY = 40;
            const keyPressed = event.keyCode;  const goingUp = dy === -10;  const goingDown = dy === 10;  const goingRight = dx === 10;  const goingLeft = dx === -10;
            if (keyPressed === LEFT_KEY && !goingRight) {    dx = -10;    dy = 0;  }
            if (keyPressed === UP_KEY && !goingDown) {    dx = 0;    dy = -10;  }
            if (keyPressed === RIGHT_KEY && !goingLeft) {    dx = 10;    dy = 0;  }
            if (keyPressed === DOWN_KEY && !goingUp) {    dx = 0;    dy = 10;  }
            
        }
        function randomTen(min, max) {  return Math.round((Math.random() * (max-min) + min) / 10) * 10;}
        function createFood() {  
            foodX = randomTen(0, canvas.width - 10);
            foodY = randomTen(0, canvas.height - 10);
            snake.forEach(function isFoodOnSnake(part) {    
            const foodIsOnSnake = part.x == foodX && part.y == foodY;
            if (foodIsOnSnake)      createFood();
            });
        }
        function drawFood() { 
        context.fillStyle = 'red';
        context.strokestyle = 'darkred';
        context.fillRect(foodX, foodY, 10, 10);
        context.strokeRect(foodX, foodY, 10, 10);
        }
        function didGameEnd() {  
            for (let i = 4; i < snake.length; i++) {
                const didCollide = snake[i].x === snake[0].x &&      snake[i].y === snake[0].y;
                if (didCollide) return true;
                }
                
        
        }
        createFood();
        drawFood();

        function playSnake(event){
           anaconda = setInterval(moveSnake, snakeSpeed);
           clearSelection()            
        }
        
        
        
    </script>

    </body>

</html>